import{w as k,n as C}from"./chunk-ZYFC6VSF-DwndViN8.js";import{r as o,j as e}from"./jsx-runtime-80hHRZYR.js";import{s as j}from"./supabaseClient-DDNOmXCv.js";const y=()=>e.jsx("div",{className:"flex justify-center items-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-indigo-500"})}),E=()=>e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})}),I=({onLogout:r})=>{const[t,s]=o.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>s(!t),className:"p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Open menu",children:e.jsx(E,{})}),t&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-gray-800 rounded-lg shadow-xl z-10 border border-gray-700",children:e.jsx("button",{onClick:()=>{r(),s(!1)},className:"block w-full text-left px-4 py-3 text-sm text-red-400 hover:bg-red-500 hover:text-white transition-colors duration-200",children:"Log Out"})})]})},D=()=>e.jsx("header",{className:"p-6 bg-gray-900 text-white rounded-t-xl shadow-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold font-serif tracking-wider",children:"Pythia"}),e.jsx("p",{className:"text-indigo-300 mt-3 text-lg",children:"Paste your astrological chart data and ask any question about it."})]})}),P=()=>{const[r,t]=o.useState(!1);return e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{type:"button",onClick:()=>t(!r),className:"text-indigo-400 hover:text-indigo-300 transition text-sm mb-2 inline-flex items-center focus:outline-none",children:[r?"Hide Instructions":"How can I get my birth data?",e.jsx("svg",{className:`w-4 h-4 ml-1 transform transition-transform ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),r&&e.jsxs("div",{className:"p-4 bg-gray-800 rounded-lg border border-gray-700 text-gray-300 text-sm space-y-4 prose prose-invert prose-sm max-w-none",children:[e.jsxs("p",{children:["Go to"," ",e.jsx("a",{href:"http://astrodienst.com/",target:"_blank",rel:"noopener noreferrer",className:"text-indigo-400 hover:underline",children:"astrodienst.com"}),", navigate to"," ",e.jsx("strong",{children:"Horoscopes > Extended Chart Selection"}),', and add a new person or select an existing one. Click "Show the Chart," then near the top of the page, click'," ",e.jsx("strong",{children:"PDF Show Additional Tables"}),". Copy everything under the ",e.jsx("strong",{children:"Planetary positions"})," section and paste it into the app."]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-200",children:"Example data:"}),e.jsx("pre",{className:"bg-gray-900 p-3 whitespace-pre-wrap rounded-md text-xs overflow-x-auto max-h-48 overflow-y-auto",children:`Planet positions Jul.Day (http://jul.day/) 2448974.351378 TT, pT 59.1 sec Planet Longitude house Speed Latitude Declination A Sun i 26Â°10' 5" 9 1Â° 1' 5" 0Â° 0' 1" S 23Â°23' 4" S B Moon g 9Â°51'41" 7 13Â°58'27" 5Â° 1' 8" S 8Â°31' 7" S C Mercury i 7Â° 0'53" 8 1Â°21'12" 1Â°20'39" N 20Â° 9'22" S D Venus k 10Â°36'19" 11 1Â° 9'18" 2Â° 8'55" S 19Â°38'42" S E Mars d 25Â° 8'50"# 4 - 15'36" 3Â°20'39" N 24Â°23'34" N F Jupiter g 12Â° 2' 0" 7 7'12" 1Â°14'53" N 3Â°36'28" S G Saturn k 14Â°56'53" 11 5'33" 1Â° 0'50" S 17Â°19'15" S O Uranus j 16Â°50'50" 10 3'24" 0Â°24'40" S 22Â°47' 8" S I Neptune j 17Â°50' 3" 10 2' 9" 0Â°40'36" N 21Â°34'50" S J Pluto h 24Â° 8'14" 8 2' 8" 14Â° 7'35" N 5Â° 5'20" S K Mean Node i 21Â°10'29" 9 - 3'11" 0Â° 0' 0" N 23Â° 8'45" S L True Node i 21Â°29'51"D 9 14" 0Â° 0' 0" N 23Â°10' 1" S N Chiron e 23Â°28' 0"# 5 - 1'14" 6Â°58'16" S 7Â° 6'19" N Houses (Plac.) Declination Asc. a 7Â° 1'20" 2Â°47'15" N 2 b 14Â°35' 2" 16Â°12'50" N 3 c 11Â°25'45" 22Â° 9' 9" N IC d 4Â°11'10" 23Â°22'24" N 5 d 27Â°34' 1" 20Â°38'52" N 6 e 26Â°29'37" 12Â°41' 6" N Desc. g 7Â° 1'20" 2Â°47'15" S 8 h 14Â°35' 2" 16Â°12'50" S 9 i 11Â°25'45" 22Â° 9' 9" S MC j 4Â°11'10" 23Â°22'24" S 11 j 27Â°34' 1" 20Â°38'52" S 12 k 26Â°29'37" 12Â°41' 6" S`})]}),e.jsxs("div",{className:"mt-4 p-3 bg-indigo-900/50 rounded-lg border border-indigo-700",children:[e.jsx("h4",{className:"font-bold text-indigo-300",children:"Pro Tip ðŸ’¡"}),e.jsx("p",{className:"mt-1",children:`You can put in multiple people's data to ask synastry questions. Just label each person with a name right above their birth data, and then ask something like, "What are the strengths between Mike and I?"`})]})]})]})},M=({onSubmit:r,isLoading:t,message:s,clearMessage:h})=>{const[i,m]=o.useState(""),[l,d]=o.useState(""),p=a=>{if(a.preventDefault(),!i.trim()||!l.trim()){h();return}r(i,l)};return e.jsxs("form",{onSubmit:p,className:"p-6 md:p-8 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"chartData",className:"block text-lg font-medium text-gray-200 mb-2",children:"Astrological Data"}),e.jsx(P,{}),e.jsx("textarea",{id:"chartData",name:"chartData",rows:10,value:i,onChange:a=>m(a.target.value),placeholder:"Paste your complete birth chart data here...",className:"w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition",disabled:t,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"userQuestion",className:"block text-lg font-medium text-gray-200 mb-2",children:"Your Question"}),e.jsx("input",{id:"userQuestion",name:"userQuestion",type:"text",value:l,onChange:a=>d(a.target.value),placeholder:"e.g., What does my Mars in Scorpio reveal?",className:"w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition",disabled:t,required:!0})]}),s&&e.jsx("div",{className:"text-center text-red-400 bg-red-900 bg-opacity-50 p-3 rounded-lg border border-red-500",children:s}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"submit",className:"px-8 py-3 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-500 focus:ring-opacity-50 disabled:bg-gray-500 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-105",disabled:t,children:t?"Thinking...":"Ask"})})]})},L=({isLoading:r,response:t,error:s})=>{const h=()=>{if(r)return e.jsx(y,{});if(s)return e.jsx("div",{className:"text-red-400 bg-red-900 bg-opacity-50 p-4 rounded-lg border border-red-500",children:s});if(t){const i=t.replace(/\n/g,"<br />");return e.jsx("div",{className:"text-gray-300 leading-relaxed prose prose-invert max-w-none",dangerouslySetInnerHTML:{__html:i}})}return e.jsx("div",{className:"text-center text-gray-500 italic",children:"Enter a question above to see results here."})};return e.jsxs("div",{className:"p-6 md:p-8 bg-gray-800 bg-opacity-50 rounded-b-xl min-h-[200px] flex flex-col justify-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-white mb-4 border-b border-gray-600 pb-2",children:"Results"}),e.jsx("div",{className:"mt-4",children:h()})]})},U=k(function(){const t=C(),[s,h]=o.useState(null),[i,m]=o.useState(!0),[l,d]=o.useState(!1),[p,a]=o.useState(""),[w,f]=o.useState(null),[N,g]=o.useState("");o.useEffect(()=>{(async()=>{try{const{data:{session:n},error:x}=await j.auth.getSession();if(x)throw x;n&&n.user?h(n.user.id):t("/home")}catch(n){n instanceof Error?console.error("Error fetching user session:",n.message):console.error("Error fetching user session:",n),t("/home")}finally{m(!1)}})()},[t]);const v=async()=>{const{error:c}=await j.auth.signOut();c&&console.error("Error logging out:",c.message),t("/home")},S=async(c,n)=>{if(d(!0),a(""),f(null),g(""),!s){d(!1),g("User not authenticated. Please log in.");return}if(!c.trim()||!n.trim()){d(!1),g("Please fill in your Chart Data and your Question.");return}const x="https://dominique.cc/astrology/api";try{const u=await fetch(`${x}/query`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:s,chartData:c,userQuestion:n})}),b=await u.json();if(!u.ok)throw new Error(b.error||`API Error: ${u.status}`);if(!b.response)throw new Error("The response from the server was empty or malformed.");a(b.response)}catch(u){u instanceof Error?f(u.message):f("An unknown error occurred.")}finally{d(!1)}};return i?e.jsx(y,{}):e.jsxs("div",{className:"bg-gray-900 min-h-screen font-sans text-white relative",children:[e.jsx("div",{className:"fixed top-4 right-4 z-20",children:e.jsx(I,{onLogout:v})}),e.jsx("div",{className:"p-4 sm:p-6 lg:p-8 flex items-center justify-center",children:e.jsxs("div",{className:"w-full max-w-4xl mx-auto bg-gray-800 rounded-xl shadow-2xl shadow-indigo-900/50 overflow-hidden",children:[e.jsx(D,{}),e.jsxs("main",{children:[e.jsx(M,{onSubmit:S,isLoading:l,message:N,clearMessage:()=>g("")}),e.jsx(L,{isLoading:l,response:p,error:w})]})]})})]})});export{U as default};
